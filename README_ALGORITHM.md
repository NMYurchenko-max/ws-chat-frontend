# Алгоритм решения и реализация функциональности чата

## 1. Регистрация пользователя с уникальным ID

- При вводе никнейма на фронтенде вызывается функция `createRequest`, которая отправляет POST запрос на backend `/new-user`.
- Backend проверяет уникальность имени, создает пользователя с уникальным `id` (UUID) и возвращает объект пользователя.
- Фронтенд сохраняет объект пользователя с `id` и `name` в состоянии.

## 2. Установка WebSocket соединения

- После успешной регистрации вызывается метод `connect` класса `ChatAPI`, который устанавливает WebSocket соединение с сервером.
- При открытии соединения отправляется сообщение с типом `connect` и именем пользователя.

## 3. Отправка сообщений

- При вводе сообщения и нажатии кнопки "Отправить" вызывается метод `sendMessage` класса `ChatAPI`.
- Сообщение отправляется на сервер в формате JSON с полями:
  ```json
  {
    "type": "send",
    "message": "текст сообщения",
    "user": {
      "id": "уникальный id пользователя",
      "name": "имя пользователя"
    }
  }
  ```

## 4. Обработка сообщений и обновление UI

- Сервер рассылает сообщения всем подключенным клиентам.
- Фронтенд подписывается на события WebSocket и обновляет список сообщений и пользователей.
- Сообщения отображаются с указанием имени пользователя.

## 5. Тестирование e2e

- Используется Puppeteer для автоматизации браузера.
- Тесты проверяют регистрацию пользователя, отправку сообщений и отображение сообщений в UI.
- Добавлены скриншоты после регистрации и после отправки сообщения для демонстрации.

## 6. Файлы и функции

- `ws-chat-frontend/src/js/api/createRequest.js` — функция для регистрации пользователя через POST запрос.
- `ws-chat-frontend/src/js/Chat.js` — основной класс чата, реализующий логику UI и взаимодействие с API.
- `ws-chat-frontend/src/js/api/ChatAPI.js` — класс для работы с WebSocket.
- `backend/server.js` — backend сервер с REST API и WebSocket сервером.
- `ws-chat-frontend/e2e/e2e.test.js` — e2e тесты с Puppeteer.

## 7. Запуск приложения и тестирование

- Для запуска backend сервера:
  - Установить зависимости: `npm install` в папке `backend`.
  - Запустить сервер: `node server.js` или `npm start` (если настроено).
- Для запуска frontend:
  - Установить зависимости: `npm install` или `yarn` в папке `ws-chat-frontend`.
  - Собрать проект с помощью webpack: `npm run build` или `yarn build`.
  - Запустить локальный сервер для фронтенда (например, `npm start` или через `webpack-dev-server`).
- Для запуска e2e тестов:
  - Убедиться, что backend и frontend запущены.
  - Запустить тесты: `npm test` или `jest` в папке `ws-chat-frontend/e2e`.

---

Данный алгоритм обеспечивает корректную регистрацию пользователей с уникальными id, обмен сообщениями через WebSocket и покрытие функционала автоматизированными тестами.
